@model VoteHomWebApp.Models.ElectionInfo
@{
    ViewData["Title"] = "Bem-vindo ao Sistema de Votação";
}

<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow-sm">
            <div class="card-body text-center py-5">
                <div class="funcorsan-logo mb-4" style="font-size: 2rem;">
                    <div style="color: #0066cc;">◆◆</div>
                    <div style="font-size: 1.5rem; margin-top: 10px;">FUNCORSAN</div>
                    <div style="font-size: 0.9rem; color: #666; font-weight: normal;">Seu futuro mais presente</div>
                </div>

                <h2 class="mb-4">Bem-vindo ao Sistema de Votação</h2>
                
                @if (!string.IsNullOrEmpty(TempData["ErrorMessage"] as string))
                {
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        @TempData["ErrorMessage"]
                    </div>
                }
                
                @if (!string.IsNullOrEmpty(ViewBag.ErrorMessage as string))
                {
                    <div class="alert alert-danger">
                        <i class="fas fa-times-circle"></i>
                        @ViewBag.ErrorMessage
                    </div>
                }
                
                @if (!string.IsNullOrEmpty(ViewBag.StatusMessage as string))
                {
                    var electionStatus = ViewBag.ElectionStatus as string ?? "info";
                    var alertClass = electionStatus switch 
                    {
                        "not_started" => "alert-warning",
                        "ended" => "alert-danger", 
                        "active" => "alert-success",
                        _ => "alert-info"
                    };
                    var iconClass = electionStatus switch 
                    {
                        "not_started" => "fas fa-clock",
                        "ended" => "fas fa-times-circle", 
                        "active" => "fas fa-check-circle",
                        _ => "fas fa-info-circle"
                    };
                    
                    <div class="alert @alertClass">
                        <i class="@iconClass"></i>
                        <div style="white-space: pre-line;">@ViewBag.StatusMessage</div>
                    </div>
                }
                
                @{
                    var isActive = Model.IsVotingPeriod;
                }
                
                @if (isActive)
                {
                    <div class="alert alert-success">
                        <i class="fas fa-vote-yea"></i>
                        <h4>@Model.Name</h4>
                        <p class="mb-2"><strong>Eleição ativa - Votação liberada!</strong></p>
                        <p class="mb-0">Período de votação:</p>
                        <p class="fw-bold">
                            <i class="fas fa-calendar-check"></i> @Model.StartDate.ToString("dd/MM/yyyy") às @Model.StartDate.ToString("HH:mm") até @Model.EndDate.ToString("dd/MM/yyyy") às @Model.EndDate.ToString("HH:mm")
                        </p>
                        <small class="text-success">Clique em "Entrar para Votar" para acessar.</small>
                    </div>
                }
                else
                {
                    <div class="alert alert-danger">
                        <i class="fas fa-times-circle"></i>
                        <h4>@Model.Name</h4>
                        <p class="mb-2"><strong>A eleição já foi encerrada</strong></p>
                        <p class="mb-0">Período de votação foi:</p>
                        <p class="fw-bold">
                            <i class="fas fa-calendar-times"></i> @Model.StartDate.ToString("dd/MM/yyyy") às @Model.StartDate.ToString("HH:mm") até @Model.EndDate.ToString("dd/MM/yyyy") às @Model.EndDate.ToString("HH:mm")
                        </p>
                        <small class="text-muted">O prazo para votar expirou.</small>
                    </div>
                }

                <div class="mt-4">
                    @if (isActive)
                    {
                        <p class="text-success fw-bold">
                            <i class="fas fa-check-circle"></i> Eleição disponível para votação!
                        </p>
                    }
                    else
                    {
                        <p class="text-muted">
                            O período de votação já se encerrou. Não é mais possível votar nesta eleição.
                        </p>
                    }
                </div>

                <div class="mt-4">
                    @if (isActive)
                    {
                        <a href="@Url.Action("Login", "Vote")" class="btn btn-success btn-lg me-2">
                            <i class="fas fa-sign-in-alt"></i> Entrar para Votar
                        </a>
                    }
                    else
                    {
                        <div class="alert alert-secondary mb-3">
                            <i class="fas fa-lock"></i>
                            <strong>Acesso ao login bloqueado</strong><br>
                            O sistema de login será liberado apenas durante o período ativo da eleição.
                        </div>
                    }
                    <button class="btn btn-outline-primary" onclick="location.reload()">
                        <i class="fas fa-sync-alt"></i> Atualizar Página
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Auto-refresh da página a cada 30 segundos
        setTimeout(function() {
            location.reload();
        }, 30000);
    </script>
}